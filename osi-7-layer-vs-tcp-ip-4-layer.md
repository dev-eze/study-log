# 🌐 OSI 7계층 모델 - 계층별 역할 및 예시 정리 (+ TCP/IP 4계층 대응)

> 네트워크 통신의 구조를 이해하기 위해 가장 기초가 되는 OSI 7계층 정리를 해보았따.  
> OSI 7계층 그리고 TCP/IP 4계층 모델이 자주 사용되며,  
> 두 모델 간 **계층 대응 관계**를 확인해보았다. 사실 7계층중 상위 계층이 합쳐져 4개의 계층으로 표현된 것이 4계층 모델이다. 

---

## ✅ OSI 7계층 개요

| 계층 | 이름 (한글)      | 주요 역할                         | 예시 프로토콜/기능                     |
|------|------------------|------------------------------------|----------------------------------------|
| L7   | Application (응용 계층) | ✅ 애플리케이션 목적에 맞는 통신 방법 제공     | `HTTP`, `HTTPS`, `DNS`, `FTP`          |
| L6   | Presentation (표현 계층) | ✅ 데이터 포맷 관리 (포맷, 인코딩, 암호화) | 인코딩 ↔ 디코딩, 암호화 ↔ 복호화       |
| L5   | Session (세션 계층)      | ✅ 세션 생성/관리, 연결 유지                  | `RPC`, 세션 복구/동기화                |
| L4   | Transport (전송 계층)    | ✅ 애플리케이션 간 통신      | `TCP`, `UDP`, 포트 번호 기반 전송       |
| L3   | Network (네트워크 계층)  | ✅ 호스트 간 통신(IP 기반), 라우팅            | `IP`, 라우팅, 최적 경로 결정            |
| L2   | Data Link (데이터 링크 계층) | ✅ 동일 네트워크 내 장치 간 통신(MAC 기반) | `Ethernet`, `ARP` (IP → MAC 매핑)      |
| L1   | Physical (물리 계층)     | ✅ 비트 단위로 물리적 전송                     | 케이블, 허브, 전기 신호, 광섬유 등      |

-목적지 애플리케이션으로 데이터 전송
안정적이고 신뢰할 수 있는 데이터 전송 보장하는 tcp와 데이터 유실과 순서 보장이 안되는 필수 기능만 제공하는 udp가 있음
- arp프로토콜을 사용하여 ip를 맥주소로 변경하여 통신(장치간 통신)
---

## ✅ TCP/IP 4계층 모델과 OSI 7계층 대응

> TCP/IP 4계층은 실무에서 더 많이 사용되며, OSI 7계층을 **다음과 같이 통합**하여 구성한다
- TCP/IP는 OSI 상위 계층을 모두 Application으로 통합하여 단순화

| TCP/IP 계층 | 포함하는 OSI 계층 | 주요 역할 및 프로토콜 예시                        |
|-------------|--------------------|---------------------------------------------------|
| ✅ Application | OSI L7 + L6 + L5 | 사용자 애플리케이션과 직접 상호작용. `HTTP`, `FTP`, `DNS` |
| ✅ Transport   | OSI L4            | 애플리케이션 간 데이터 전송. `TCP`, `UDP`        |
| ✅ Internet    | OSI L3            | IP 기반 라우팅과 호스트 간 통신. `IP`, `ICMP`    |
| ✅ Network Access (Link) | OSI L2 + L1 | 장치 간 물리적 전송. `Ethernet`, `MAC`, `ARP`    |

--- 
- OSI 7계층의 상위 3개 계층(세션, 표현, 응용)은 **TCP/IP의 Application 계층**에 모두 포함됨
- 실무에서 흔히 말하는 “L4 스위치”, “L7 로드밸런서”는 **OSI 기준**
    - L4 스위치: TCP/UDP 포트 기반 라우팅
    - L7 로드밸런서: HTTP 헤더/메서드 등 애플리케이션 데이터 기반 라우팅

## ✅ 계층별 보충 설명

### 🔹 L7 - Application Layer

- 애플리케이션이 사용하는 프로토콜
- **HTTP, HTTPS, DNS, FTP 등**
- 사용자와 가장 밀접한 계층

### 🔹 L6 - Presentation Layer

- 데이터 표현 방식, 포맷 일치화
- ✅ **인코딩/디코딩, 암호화/복호화**

### 🔹 L5 - Session Layer

- 세션 유지/관리, 인증, 동기화
- ✅ 예: 원격 프로시저 호출(`RPC`)

### 🔹 L4 - Transport Layer

- 목적지 애플리케이션(포트)까지 데이터 전달
- **TCP**: 신뢰성 보장, 순서 보장, 재전송  
- **UDP**: 빠르지만 유실 가능, 순서 미보장

📌 TCP는 HTTP/HTTPS 기반에서 필수 사용

### 🔹 L3 - Network Layer

- 호스트 간의 통신
- **IP 주소** 기반 데이터 전송, 라우팅 처리
- 예: `IP`, `ICMP`, `IGMP`

### 🔹 L2 - Data Link Layer

- 같은 네트워크 내 **노드 간 통신**
- **MAC 주소** 기반, **ARP**를 통해 IP → MAC 변환
- 예: `Ethernet`, `PPP`, `ARP`

### 🔹 L1 - Physical Layer

- 실제 장치 간 전송 (전기, 광신호, 무선 등)
- 전송 단위: **비트(bit)**
- 예: 케이블, 허브, 리피터

## ✅ TCP 통신의 시작과 끝

### 🔹 3-Way Handshake (연결 수립)

1. **클라이언트 → 서버 : SYN**  
   클라이언트가 연결 요청 (`SYN=1`, `seq=x`) 전송

2. **서버 → 클라이언트 : SYN + ACK**  
   서버가 요청 수락 + 응답 준비 (`SYN=1`, `ACK=1`, `seq=y`, `ack=x+1`)

3. **클라이언트 → 서버 : ACK**  
   클라이언트가 확인 응답 (`ACK=1`, `ack=y+1`)
✅ 연결 성립 후 데이터 전송 시작
---
✅ `L7 로드밸런서`는 HTTP 내용을 읽고, 경로(`/login`)에 따라 백엔드 서버에 전달  
✅ TCP 3-way 핸드셰이크는 **HTTP 요청 전** 반드시 선행됨

## ✅ L4 / L7 로드밸런서의 동작 차이

| 항목          | L4 로드밸런서                       | L7 로드밸런서                       |
|---------------|-------------------------------------|-------------------------------------|
| 기준 계층      | Transport Layer (L4)                | Application Layer (L7)              |
| 판단 기준      | IP, Port, TCP/UDP 헤더               | HTTP Method, URL, Cookie 등         |
| 특징           | 빠르고 단순 (속도↑, 유연성↓)       | 복잡하지만 정밀 제어 가능 (속도↓, 유연성↑) |
| 예시           | AWS NLB, LVS     
